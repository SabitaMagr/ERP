
@{
    var myAreaName = string.Empty;
    object areaObj;
    if (ViewContext.RouteData.Values.TryGetValue("area", out areaObj))
    {
        myAreaName = areaObj.ToString();
    }
}
<style>
    legend {
        width: 9%;
    }

    .excelfile {
        font-size: 16px;
    }

    .required {
        color: red;
        font-size: 11px !important;
    }

    .k-grid-content.k-auto-scrollable {
        height: 400px !important;
    }

    i.fa.fa-file-image-o.image {
        margin: 1px;
    }

    .k-list.k-reset {
        max-height: 200px !important;
        overflow: auto !important;
    }

    div#grid {
        height: 500px;
    }

    .image-placeholder > img {
        display: inline;
        margin: 1px;
        height: 40px;
        width: 40px;
    }

    .form-group.image-placeholder > div {
        display: inline-block;
        float: left;
        width: 78px;
    }

    #PerformaInvoiceForm .k-widget input {
        height: 16px !important;
    }

    #historymodal .modal-dialog {
        width: 1017px !important;
        margin: 30px auto;
    }

    .k-item {
        font-size: 11px !important;
    }

    .definationlist dt {
        float: left !important;
        padding-right: 5px;
        width: 59%;
        padding: 3px;
    }

    .historyitemgrid.k-grid.k-widget {
        font-size: 10px;
    }

    .historyshipmentgrid.k-grid.k-widget {
        font-size: 10px;
    }


    .historydocumentgrid.k-grid.k-widget {
        font-size: 10px;
    }

    .definationlist dd {
        padding: 3px;
    }

    .k-clear-value {
        display: none;
    }

    span.k-icon.k-i-loading {
        display: none;
    }

    .k-state-default > .k-select {
        display: none;
    }

    .alert {
        margin-bottom: 0px;
        height: 21px;
        line-height: 20px;
        padding: 0px 15px;
    }

    .alert-dismissable .close, .alert-dismissible .close {
        right: -12px;
    }
</style>
<div ng-app="myApp" ngCloak>
    <div ng-controller="PerformaInvoiceCtrl" id="PerformaInvoiceCtrl">
        <div class="portlet light bordered main">
            <div class="portlet-title titleheading">
                <i class="fa fa-list-alt fontgreen"></i>
                <span class="caption-subject fontgreen bold uppercase">
                    Proforma Invoice Entry
                </span>
                <span class="pull-right" ng-show="!showFormPanel">
                       <button type="button" id="addTarget" name="addTarget" ng-click="AddPerformaInvoice()" class="btn buttongreen btn-sm">[+] Add</button>
                </span>
                <span class="pull-right" ng-show="showFormPanel">
                    <button type="submit" id="EditContent" name="EditContent" ng-hide="ContentModal" ng-click="EditContent()" class="btn btn-default btn-sm" data-toggle="modal" data-target="#ContentModal"> Edit Content</button>
                    <button type="button" id="cancelpo" name="cancelpo" class="btn btn-default btn-sm" ng-click="cancelpi();">Cancel</button>
                    <button type="reset" id="saveandcontinue" name="saveandcontinue" class="btn btn-success btn-sm" ng-click="createperfomainvoice(PerformaInvoiceForm.$valid,'save')">{{scAction}}</button>
                    <button type="submit" id="savePerformaInvoice" name="savePerformaInvoice" ng-click="createperfomainvoice(PerformaInvoiceForm.$valid,'save')" class="btn buttongreen btn-sm">{{saveAction}}</button>
                </span>
            </div><!-- /portlet-title-->
            <div class="portlet-body">
                <div class="row">

                    <form id="PerformaInvoiceForm" name="PerformaInvoiceForm" ng-show="showFormPanel" novalidate>
                        <div class="col-sm-6 col-md-3">
                            <div class="form-group">
                                <label class="control-label">
                                    Purchase Order
                                </label>

                                <input id="perfomainvoiceautocomplete"  ng-model="pi.purchaseOrder" name="purchaseOrder" kendo-auto-complete
                                       k-data-text-field="'ORDER_NO'"
                                       k-data-value-field="'ORDER_NO'"
                                       k-data-source="ipPurchaseOrder"
                                       k-min-length="1"
                                       k-value-primitive="true"
                                       k-placeholder="'Select Purchase Order...'"
                                       k-on-select="ItemsOnChange(kendoEvent)"
                                       style="width: 100%" ng-disabled="onedit" />
                            </div>

                        </div>

                        <input type="hidden" style="display:none" ng-model="pincode" name="pincode" id="pincode" />
                        <input type="hidden" style="display:none" ng-model="lctrack" name="lctrack" id="lctrack" />

                        <div class="col-sm-6 col-md-3">
                            <div class="form-group">
                                <label class="control-label">
                                    Pinvoice No <span style="color:red" ng-show="PerformaInvoiceForm.pinvoiceno.$invalid">
                                        <span ng-show="PerformaInvoiceForm.pinvoiceno.$error.required">*</span>
                                    </span>
                                </label>
                                <input type="text" id="pinvoiceno" name="pinvoiceno" class="form-control input-sm" ng-model="pi.pinvoiceno" ng-disabled="!check_pinvoiceno"  required />
                           
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="form-group">
                                <label class="control-label">
                                    Pinvoice Date<span style="color:red" ng-show="PerformaInvoiceForm.pinvoicedate.$invalid">
                                        <span ng-show="PerformaInvoiceForm.pinvoicedate.$error.required">*</span>
                                    </span>
                                </label>
                                <input type="text" id="pinvoicedate" name="pinvoicedate" autocomplete="off" class="form-control maskdate" ng-model="pi.pinvoicedate" ng-disabled="!check_pinvoicedate" required />

                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="form-group">
                                <label class="control-label">
                                    Currency<span style="color:red" ng-show="PerformaInvoiceForm.currency.$invalid">
                                        <span ng-show="PerformaInvoiceForm.currency.$error.required">*</span>
                                    </span>
                                </label>
                                <select id="currency" k-value-primitive="true" k-ng-model="pi.currency" ng-model="pi.currencycode" name="currency" kendo-drop-down-list style="width: 100%"
                                        k-options="currencylist" ng-disabled="!check_currencycode" required></select>

                            </div>
                        </div>

                        <div ng-show="hideonedit" class="clearfix">
                            <div class="col-sm-5 col-md-4">

                                <div class="pull-left">
                                    <input id="avatar" type="file" style="float:left" name="avatar" />
                                    <a href="javascript:void(0)" class="btn btn-xs buttongreen">
                                        <i class="fa fa-upload" id="uploadimages" ng-click="ImportExcel()" aria-hidden="true"></i>
                                    </a>

                                </div>

                            </div>
                            <div class="col-sm-5 col-md-4">
                                <div class="alert alert-danger alert-dismissable">
                                    <label class="errormessage"></label>
                                </div>

                            </div>
                            <div class="col-sm-2 col-md-4">
                                <a target="_self" href="~/Pictures/ExcelFormat.xlsx" data-toggle="tooltip" title="Download Excel Format.." download><i class='fa fa-file-excel-o excelfile fontgreen pull-right' /></a>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-12">
                            <div class="portlet-body slimscroll" ng-show="ItemsShow">
                                <div class="tblresponsive">
                                    <table class="table table-striped  table-hover ctable" id="items">
                                        <thead>
                                            <tr>
                                                <th width="5%">S.N.</th>
                                                <th>Item Name <small style="opacity:0.6"></small></th>
                                                <th width="7%">MU</th>
                                                <th width="8%">Quantity</th>
                                                <th width="8%">Rate</th>
                                                <th width="10%">Total</th>
                                                <th width="12%">HS Code<small style="opacity:0.6"></small></th>
                                                <th width="15%">Country Of Origin<small style="opacity:0.6"></small></th>
                                                <th width="2%">
                                                    <a href="javascript:void(0)" ng:click="addIssue()" class="btn btn-xs buttongreen pull-right">
                                                        [<i class="fa fa-plus"></i>] Add
                                                    </a>
                                                </th>
                                            </tr>
                                        </thead>

                                        <tbody>
                                            <tr ng-show="noitems" style="font-size:10px;" ng-if="itemlist.length==0">
                                                <td colspan="9">No Items To Display..</td>
                                            </tr>

                                            <tr style="font-size:10px;" ng-if="itemlist.length!=0" ng-repeat="items in itemlist">
                                                <td style="text-align:right">{{$index +1}}</td>
                                                <td>

                                                    <input kendo-combo-box
                                                           id="items" class="items"
                                                           k-value-primitive="true"
                                                           k-placeholder="'Select Items'"
                                                           k-data-text-field="'ITEM_EDESC'"
                                                           k-data-value-field="'ITEM_CODE'"
                                                           k-filter="'contains'"
                                                           k-auto-bind="false"
                                                           k-min-length="3"
                                                           k-data-source="itemsDataSource"
                                                           ng-model="tablelist[$index].ITEM_EDESC"
                                                           k-on-select="onItemsChange(kendoEvent,$index)"
                                                           style="width: 100%" />
                                                </td>
                                                <td><input type="text" id="mucode" name="mucode" class="form-control input-sm" ng-model="tablelist[$index].MU_CODE" disabled /></td>
                                                <td><input type="number" min="0" ng-change="showtotal()" ng-blur="OnQuantityChange($index)" id="quantity" name="quantity" class="form-control input-sm" ng-model="tablelist[$index].QUANTITY" value={{items.CALC_QUANTITY | number : fractionSize}} /></td>
                                                <td><input type="number" min="0" id="value" ng-change="showtotal()" ng-blur="OnAmountChange($index)" name="value" class="form-control input-sm" ng-model="tablelist[$index].AMOUNT" value={{items.CALC_UNIT_PRICE | number : fractionSize}} /></td>
                                                <td style="text-align:right"><label ng-model="tablelist[$index].TOTAL"> {{tablelist[$index].QUANTITY * tablelist[$index].AMOUNT | number:fractionSize}} </label> </td>
                                                <td style="width:15px;">

                                                    <select id="hscodedropdown" k-value-primitive="true" k-ng-model="tablelist[$index].HS_CODE" name="tablelist[$index].hscode" kendo-drop-down-list style="width: 100%"
                                                            k-options="hscodeslist"></select>
                                                </td>
                                                <td style="width:30px;">
                                                    <select id="countrydropdown" k-value-primitive="true" k-ng-model="tablelist[$index].COUNTRY_OF_ORIGIN" name="tablelist[$index].COUNTRY_OF_ORIGIN" kendo-drop-down-list style="width: 100%"
                                                            k-options="countrylist"></select>
                                                </td>
                                                <td></td>
                                                <td ng-show="additems"></td>
                                            </tr>

                                            <tr ng-hide="hidefirstrow" ng:repeat="issue in issues">
                                                <td style="text-align:right">{{$index +1+issue.sn}}</td>
                                                <td>

                                                    <select kendo-combo-box
                                                            id="items"
                                                            k-placeholder="'Select Items'"
                                                            k-data-text-field="'ITEM_EDESC'"
                                                            k-data-value-field="'ITEM_CODE'"
                                                            k-filter="'contains'"
                                                            k-auto-bind="true"
                                                            k-min-length="3"
                                                            k-data-source="itemsDataSource"
                                                            ng-model="tablelist[$index +itemlist.length].ITEM_CODE"
                                                            k-on-change="onItemsChange(kendoEvent,$index+ itemlist.length)"
                                                            style="width: 100%"></select>
                                                </td>
                                                <td><input type="text" id="mucode" name="mucode" class="form-control input-sm" ng-model="tablelist[$index+ itemlist.length].MU_CODE" disabled /></td>
                                                <td><input type="number" min="0" ng-change="showtotal()" ng-blur="OnQuantityChange($index)" id="quantity" name="quantity" class="form-control input-sm" ng-model="tablelist[$index+ itemlist.length].QUANTITY" value={{items.CALC_QUANTITY | number : fractionSize}} /></td>
                                                <td><input type="number" min="0"  ng-change="showtotal()" id="value" ng-blur="OnAmountChange($index)" name="value" class="form-control input-sm" ng-model="tablelist[$index + itemlist.length].AMOUNT" value="0" /></td>
                                                <td style="text-align:right"><label ng-model="tablelist[$index+ itemlist.length].TOTAL"> {{tablelist[$index+ itemlist.length].QUANTITY * tablelist[$index+ itemlist.length].AMOUNT | number:fractionSize}} </label> </td>
                                                <td>
                                                    <select id="hscodedropdown" k-value-primitive="true" k-ng-model="tablelist[$index+ itemlist.length].HS_CODE" name="tablelist[$index+ itemlist.length].HS_CODE" kendo-drop-down-list style="width: 100%"
                                                            k-options="hscodeslist"></select>
                                                </td>
                                                <td>
                                                    <select id="countrydropdown" k-value-primitive="true" k-ng-model="tablelist[$index+ itemlist.length].COUNTRY_OF_ORIGIN" name="tablelist[$index+ itemlist.length].COUNTRY_OF_ORIGIN" kendo-drop-down-list style="width: 100%"
                                                            k-options="countrylist"></select>
                                                </td>
                                                <td>
                                                    [<a href="javascript:void(0)" ng:click="removeIssue($index+ itemlist.length)">X</a>]
                                                </td>
                                            </tr>
                                            <tr>
                                                <td></td>
                                                <td><b>Grand Total</b></td>
                                                <td></td>
                                                <td><b class="pull-right">{{Total_Quantity | number}}</b>  </td>
                                                <td>@*<b class="pull-right">{{Rate | number}}</b>*@ </td>
                                                <td><b class="pull-right">{{Total_Amount | number}} </b></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>


                        <div class="col-sm-6 col-md-3">
                            <div class="form-group">
                                <label class="control-label">
                                    LC Opening Due Date
                                </label>
                                <input type="text" id="docdate" autocomplete="off" name="docdate" class="form-control maskdate" ng-model="pi.docdate"  ng-disabled="!check_docdate" />

                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="form-group">
                                <label class="control-label">
                                    Beneficiary Name <span style="color:red" ng-show="PerformaInvoiceForm.beneficiaryname.$invalid">
                                        <span ng-show="PerformaInvoiceForm.beneficiaryname.$error.required">*</span>
                                    </span>
                                </label>
                                <select id="benefeciaryname" k-value-primitive="true" ng-model="pi.beneficiaryname" name="beneficiaryname" kendo-drop-down-list style="width: 100%"
                                        k-options="bnflist"  ng-disabled="!check_beneficiaryname" required></select>

                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="form-group">
                                <label class="control-label">
                                    Beneficiary Address
                                </label>
                                <input type="text" id="beneficiaryaddress" name="beneficiaryaddress" ng-model="pi.beneficiaryaddress" class="form-control input-sm"  ng-disabled="!check_beneficiaryaddress"/>

                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="form-group">
                                <label class="control-label">
                                    Intermediate Banks
                                </label>
                                <select id="intmbanks" k-value-primitive="true" k-ng-model="pi.intmbankcode" name="intmbankcode" kendo-drop-down-list style="width: 100%"
                                        k-options="intmbankOptions"  ng-disabled="!check_intmbankcode"></select>

                            </div>
                        </div>

                        <div class="col-sm-6 col-md-3">
                            <div class="form-group">
                                <label class="control-label">
                                    Intermediate Swift Code
                                </label>
                                <input type="text" id="intmswiftcode" name="intmswiftcode" ng-model="pi.intmswiftcode" class="form-control input-sm"  ng-disabled="!check_intmswiftcode"/>

                            </div>
                        </div>



                        <div class="col-sm-6 col-md-3">
                            <div class="form-group">
                                <label class="control-label">
                                    Supplier Banks
                                </label>
                                <select id="banks" k-value-primitive="true" k-ng-model="pi.bankcode" name="bankcode" kendo-drop-down-list style="width: 100%"
                                        k-options="bankOptions"  ng-disabled="!check_bankcode"></select>

                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="form-group">
                                <label class="control-label">
                                    Bank Branch
                                </label>
                                <input type="text" id="bankbranch" name="bankbranch" ng-model="pi.bankbranch" class="form-control input-sm"  ng-disabled="!check_bankbranch"/>

                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="form-group">
                                <label class="control-label">
                                    Swift Code
                                </label>
                                <input type="text" id="swiftcode" name="swiftcode" ng-model="pi.swiftcode" class="form-control input-sm"  ng-disabled="!check_swiftcode"/>

                            </div>
                        </div>


                        <div class="col-sm-6 col-md-3">
                            <div class="form-group">
                                <label class="control-label">
                                    Remarks
                                </label>
                                <input type="text" id="remarks" name="remarks" ng-model="pi.remarks" class="form-control input-sm"  ng-disabled="!check_remarks"/>

                            </div>
                        </div>
                       
                        <div class="col-sm-6 col-md-3">
                            <div class="form-group">
                                <label class="control-label block">Uploads</label>
                                <button type="button" data-toggle="modal" data-target="#itemimages" class="btn buttongreen cbtn upload">
                                    <i class="fa fa-upload iconupload" aria-hidden="true"></i>
                                    Upload
                                </button>


                            </div>
                        </div>
                        <div class="col-md-6 col-md-6">
                            <label class="control-label block"></label>
                            <div class="form-group image-placeholder">

                            </div>
                        </div>

                        <div class="topgap">
                        </div>

                    </form>
                </div>
                <div class="clearfix">
                </div>
                <kendo-grid id="grid" options="mainGridOptions" k-rebind="mainGridOptions">
                    <div k-detail-template>
                        <kendo-tabstrip>
                            <ul>
                                <li class="k-state-active">Details</li>
                                <li>Items</li>
                           </ul>
                            <div>
                                <div class="details">

                                    <div class="details">
                                        <table class="table-striped table-hover">
                                            <tr>
                                                <td class="details-label">Lc Track No:</td>
                                                <td class="details-value">{{dataItem.LC_TRACK_NO}}</td>
                                                <td class="details-label">Pinvoice No:</td>
                                                <td class="details-value">{{dataItem.PINVOICE_NO}}</td>
                                                <td class="details-label">Order No:</td>
                                                <td class="details-value">{{dataItem.ORDER_NO}}</td>
                                            </tr>
                                            <tr>
                                                <td class="details-label">Pinvoice Date:</td>
                                                <td class="details-value">{{dataItem.PINVOICE_DATE | date:"MM/dd/yyyy"}}</td>
                                                <td class="details-label">Banks:</td>
                                                <td class="details-value">{{dataItem.BANK_NAME}}</td>
                                                <td class="details-label">Swift Code:</td>
                                                <td class="details-value">{{dataItem.SWIFT_CODE}}</td>
                                            </tr>
                                            <tr>
                                                <td class="details-label">Intermediate Bank:</td>
                                                <td class="details-value">{{dataItem.INTM_BANK_EDESC}}</td>
                                                <td class="details-label">Intermediate Swift Code:</td>
                                                <td class="details-value">{{dataItem.INTM_SWIFT_CODE}}</td>
                                                <td class="details-label">Accepted Doc Date:</td>
                                                <td class="details-value">{{dataItem.ACCEPTED_DOC_DATE | date:"MM/dd/yyyy"}}</td>
                                            </tr>
                                            <tr>
                                                <td class="details-label">Bank Branch:</td>
                                                <td class="details-value">{{dataItem.BANK_BRANCH}}</td>
                                                <td class="details-label">Beneficiary Name:</td>
                                                <td class="details-value">{{dataItem.BNF_NAME}}</td>
                                                <td class="details-label">Beneficiary Address:</td>
                                                <td class="details-value">{{dataItem.BNF_ADDRESS}}</td>
                                            </tr>
                                            <tr>
                                                <td class="details-label">Remarks:</td>
                                                <td class="details-value">{{dataItem.REMARKS}}</td>
                                             
                                            </tr>

                                        </table>

                                    </div>


                                </div>
                            </div>
                            <div>
                                <div class="itemgrid" kendo-grid k-options="itemGridOptions(dataItem)"></div>
                            </div>
                        
                        </kendo-tabstrip>
                    </div>
                </kendo-grid>
            </div>

            @Html.Partial("~/Views/Shared/Controls/_GridToolbar.cshtml")
          
            <div class="modal fade" id="FilterModal" role="dialog">
                <div class="modal-dialog">

                    <!-- Filter Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Filter</h4>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-sm-12 col-md-12">
                                    <div class="form-group">
                                        <label class="control-label">
                                            Purchase Order
                                        </label>

                                        <input id="FilterDatapurchaseOrder"  ng-model="filterData.purchaseOrder" name="purchaseOrder" kendo-auto-complete
                                               k-data-text-field="'ORDER_NO'"
                                               k-data-value-field="'ORDER_NO'"
                                               k-data-source="ipPurchaseOrderfilter"
                                               k-min-length="1"
                                               k-value-primitive="true"
                                               k-placeholder="'Select Purchase Order...'"
                                               style="width: 100%" />
                                    </div>

                                </div>
                        
                             
                                <div class="col-sm-12 col-md-12">
                                    <div class="form-group">
                                        <label class="control-label">
                                            Pinvoice No
                                        </label>

                                        <input id="FilterDatapinvoiceno" ng-model="filterData.pinvoiceno" name="pinvoiceno" kendo-auto-complete
                                               k-data-text-field="'PINVOICE_CODE'"
                                               k-data-value-field="'PINVOICE_CODE'"
                                               k-data-source="ipPurchaseInvoicefilter"
                                               k-min-length="1"
                                               k-value-primitive="true"
                                               k-placeholder="'Select Invoice Number...'"
                                              style="width: 100%" />
                                
                                    </div>
                                </div>
                                <div class="col-sm-12 col-md-12">
                                    <div class="form-group">
                                        <label class="control-label">
                                            Pinvoice Date
                                        </label>
                                        <input type="text" id="FilterDatapinvoicedate" name="FilterDatapinvoicedate" autocomplete="off" class="form-control maskdate" ng-model="filterData.pinvoicedate"  />

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="savePerformaInvoice" name="savePerformaInvoice" ng-click="Filter()" class="btn buttongreen btn-sm">Filter</button>
                            <button type="button" class="btn btn-default"   ng-click="CancelFilter()" data-dismiss="modal">Cancel</button>
                        </div>
                    </div>

                </div>
            </div>
            <div class="modal fade" id="itemimages" tabindex="-1" role="dialog" aria-labelledby="filterModalLabel">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <div class="form-inline">
                            </div>
                            <h4 class="modal-title">Image Upload</h4>
                        </div>

                        <form action="~/LOC/ProformaInvoice/FileUpload" method="post" enctype="multipart/form-data" class="dropzone form-horizontal form-bordered" id="myAwesomeDropzone">
                            <div class="form-group form-actions">
                                <div class="col-md-9 col-md-offset-4">
                                    <input type="text" style="display:none" ng-model="pinvoicecode" name="pinvoicecode" id="pinvoicecode" />
                                    <input type="text" style="display:none" ng-model="lctrackno" name="lctrackno" id="lctrackno" />
                                </div>
                            </div>
                        </form>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-success pull-right" data-dismiss="modal" aria-hidden="true">Ok</button>

                        </div>
                    </div>
                </div>
            </div>
            <div class="modal fade" id="historymodal" tabindex="-1" role="dialog" aria-labelledby="filterModalLabel">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <div class="form-inline">

                            </div>
                            <h4 class="modal-title">Document History</h4>
                        </div>
                        <div id="example" ng-app="KendoDemos">
                            <div class="demo-section k-content">

                                <div kendo-tab-strip k-content-urls="[ null, null]">
                                    <!-- tab list -->
                                    <ul>
                                        <li class="k-state-active">Items History</li>
                                    
                                        <li>Document History</li>
                                    </ul>

                                    <div style="padding: 1em">
                                        <div class="historyitemgrid" k-rebind="historyitemGridOptions" kendo-grid k-options="historyitemGridOptions(dataItem)"></div>
                                    </div>

                                  
                                    <div style="padding: 1em">
                                        <div class="historydocumentgrid" k-rebind="historydocumentGridOptions" kendo-grid k-options="historydocumentGridOptions(dataItem)"></div>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-success pull-right" data-dismiss="modal" aria-hidden="true">Ok</button>

                        </div>
                    </div>


                </div>
            </div>
        </div>
        <div class="modal fade" id="ContentModal" role="dialog">
            <div class="modal-dialog inputcontent">

                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Enable/Disable</h4>
                    </div>
                    <div class="modal-body">
                        <!------------------------------------------For All Enable/Disable------------------------------------>
                        <div class="row">
                            <div class="col-md-4">
                                <input type="checkbox" ng-change='AllcheckboxEnableDisable()' id="Allcheckbox" ng-model="Allcheckbox" />
                                All
                            </div>
                        </div>
                        <!------------------------------------------For Plan shippment-------------------------------------->
                        <div>

                            <input type="checkbox" ng-model="check_pinvoiceno" class="enabledisable" />
                            Pinvoice No <br>

                            <input type="checkbox" ng-model="check_pinvoicedate" class="enabledisable" />
                            Pinvoice Date <br>

                            <input type="checkbox" ng-model="check_currencycode" class="enabledisable" />
                            Currency <br>

                            <input type="checkbox" ng-model="check_docdate" class="enabledisable" />
                            LC Opening Due Date <br>

                            <input type="checkbox" ng-model="check_beneficiaryname" class="enabledisable" />
                            Beneficiary Name <br>

                            <input type="checkbox" ng-model="check_beneficiaryaddress" class="enabledisable" />
                            Beneficiary Address<br>
                            <input type="checkbox" ng-model="check_intmbankcode" class="enabledisable" />
                            Intermediate Banks <br>

                            <input type="checkbox" ng-model="check_intmswiftcode" class="enabledisable" />
                            Intermediate Swift Code <br>


                            <input type="checkbox" ng-model="check_bankcode" class="enabledisable" />
                            Supplier Banks <br>

                            <input type="checkbox" ng-model="check_bankbranch" class="enabledisable" />
                            Bank Branch <br>

                            <input type="checkbox" ng-model="check_swiftcode" class="enabledisable" />
                            Swift Code<br>
                            <input type="checkbox" ng-model="check_remarks" class="enabledisable" />
                            Remarks <br>

                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" data-dismiss="modal">Ok</button>
                        </div>
                    </div>

                </div>
            </div>
            <!--container end -->
        </div>
    </div><!--/portlet-body-->
</div><!-- /portlet-->



<script type="text/javascript">
    $(document).ready(function () {
        $('.alert').css({ display: 'none' });

    })
    $('.nav-tabs a').on('click', function (e) {

        e.preventDefault();

    });
    myDropzone = new Dropzone('#myAwesomeDropzone', { // Make the whole body a dropzone
        thumbnailWidth: 200,
        thumbnailHeight: 75,
        autoDiscover: false,
        autoProcessQueue: false,
        addRemoveLinks: true,
        paramName: "inputFiles",
        uploadMultiple: true,
        parallelUploads: 100,
        maxFiles: 100,
        maxFileSize: 10,
    });

    myDropzone.on("success", function (file, responseText) {

        if (responseText.status == "Error") {

            displayPopupNotification("File upload does not success. Please update.", "error");
        }
        else {
            this.removeFile(file);
            RefreshGrid();

        }


    });

    function RemoveImage(el) {
     
        var $this = $(this);
        bootbox.confirm("Are you sure you want to delete?", function (result) {

            if (result) {

                var imageremovedetails = {
                    Path: $(el).data("src"),
                    LocCode: $('#pinvoicecode').val(),
                
                };

                $.ajax({
                    url: "/api/ProformaInvoice/RemovePoImage",
                    type: "POST",
                    dataType: "json",
                    data: imageremovedetails,
                    success: function (result) {
                        RefreshGrid();
                        el.closest('div').remove();
                        displayPopupNotification("Succesfully Removed File.", "Success");
                    },
                    error: function (result) {
                       
                    }
                });

            }
        });

    }

    $('#uploadimages').click(function () {
        if (window.FormData !== undefined) {
            showloader();
            var file_data = $("#avatar").prop("files")[0];   // Getting the properties of file from file field
            var form_data = new FormData();                  // Creating object of FormData class
            form_data.append("file", file_data)

            $.ajax({
                url: '/ProformaInvoice/Import',
                type: "POST",
                contentType: false,
                processData: false,
                data: form_data,
                success: function (result) {
                 
                    if (result == "empty") {
                        $('.alert').css({ display: 'block' });
                        $('.errormessage').html("Please select a excel file.");
                        hideloader();
                    }
                    else if (result == "fileincorrect") {
                        $('.alert').css({ display: 'block' });
                        $('.errormessage').html("Other inputs rather than excel file is invalid.");
                        hideloader();
                    }
                    else if (result == "formaterror") {
                        $('.alert').css({ display: 'block' });
                        $('.errormessage').html("Please manage the excel file as per giver format.");
                        hideloader();
                    }
                    else {
                     ;
                        angular.element('#PerformaInvoiceCtrl').scope().BindDataFromExcelFile(result);
                        $('.alert').css({ display: 'none' });
                        $('#avatar').val("");
                        hideloader();
                    }
                },
                error: function (err) {
                    displayPopupNotification(err.statusText, "error");
                }
            });
        } else {
            alert("FormData is not supported.");
        }
    });

    function RefreshGrid() {
        $("#grid").data("kendoGrid").dataSource.read();
    }

</script>
